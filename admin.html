<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Brandorivk</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f4f4;
            padding: 2rem;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        h1 { margin-bottom: 1.5rem; color: #1a1a1a; }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
        }
        .stat-card h3 { font-size: 2rem; margin-bottom: 0.5rem; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 2rem;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th { background: #f8f9fa; font-weight: 600; }
        tr:hover { background: #f8f9fa; }
        .product-img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            margin: 0 4px;
        }
        .btn-edit { background: #3498db; color: white; }
        .btn-delete { background: #e74c3c; color: white; }
        .btn-add { background: #27ae60; color: white; margin-bottom: 1rem; }
        .btn-save { background: #e67e22; color: white; }
        input, select, textarea {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 4px;
            width: 100%;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .form-group { margin-bottom: 1rem; }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        .close { float: right; font-size: 1.5rem; cursor: pointer; }
        .low-stock { color: #e74c3c; font-weight: bold; }
        .in-stock { color: #27ae60; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š Admin Panel - Product Management</h1>
        
        <div class="stats">
            <div class="stat-card">
                <h3 id="totalProducts">0</h3>
                <p>Total Products</p>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <h3 id="totalValue">$0</h3>
                <p>Inventory Value</p>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <h3 id="lowStockCount">0</h3>
                <p>Low Stock Items</p>
            </div>
        </div>

        <button class="btn btn-add" onclick="openModal()">+ Add New Product</button>
        <button class="btn btn-save" onclick="saveToConfig()">ðŸ’¾ Save Changes to Config</button>

        <table>
            <thead>
                <tr>
                    <th>Image</th>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Stock</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="productTable"></tbody>
        </table>
    </div>

    <!-- Edit/Add Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Add Product</h2>
            <form id="productForm">
                <input type="hidden" id="productId">
                <div class="form-group">
                    <label>Product Name *</label>
                    <input type="text" id="pName" required>
                </div>
                <div class="form-group">
                    <label>Category *</label>
                    <select id="pCategory" required>
                        <option value="tshirt">T-Shirt</option>
                        <option value="shirt">Shirt</option>
                        <option value="pants">Pants</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Price ($) *</label>
                    <input type="number" id="pPrice" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Stock Quantity *</label>
                    <input type="number" id="pStock" required>
                </div>
                <div class="form-group">
                    <label>Image URL *</label>
                    <input type="url" id="pImage" required placeholder="https://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="pDescription" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-save">Save Product</button>
            </form>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', loadProducts);

        function loadProducts() {
            const tbody = document.getElementById('productTable');
            const products = getProducts();
            
            tbody.innerHTML = '';
            let totalValue = 0;
            let lowStock = 0;

            products.forEach(product => {
                totalValue += product.price * product.stock;
                if (product.stock < 5) lowStock++;

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><img src="${product.image}" class="product-img" alt="${product.name}"></td>
                    <td><strong>${product.name}</strong></td>
                    <td>${product.category}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>${product.stock}</td>
                    <td class="${product.stock < 5 ? 'low-stock' : 'in-stock'}">
                        ${product.stock < 5 ? 'âš ï¸ Low Stock' : 'âœ… In Stock'}
                    </td>
                    <td>
                        <button class="btn btn-edit" onclick="editProduct(${product.id})">Edit</button>
                        <button class="btn btn-delete" onclick="deleteProduct(${product.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalValue').textContent = '$' + totalValue.toFixed(2);
            document.getElementById('lowStockCount').textContent = lowStock;
        }

        function openModal(productId = null) {
            const modal = document.getElementById('productModal');
            const form = document.getElementById('productForm');
            
            if (productId) {
                const product = getProductById(productId);
                document.getElementById('modalTitle').textContent = 'Edit Product';
                document.getElementById('productId').value = product.id;
                document.getElementById('pName').value = product.name;
                document.getElementById('pCategory').value = product.category;
                document.getElementById('pPrice').value = product.price;
                document.getElementById('pStock').value = product.stock;
                document.getElementById('pImage').value = product.image;
                document.getElementById('pDescription').value = product.description;
            } else {
                document.getElementById('modalTitle').textContent = 'Add Product';
                form.reset();
                document.getElementById('productId').value = '';
            }
            
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        document.getElementById('productForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const id = document.getElementById('productId').value;
            const products = getProducts();
            
            const productData = {
                name: document.getElementById('pName').value,
                category: document.getElementById('pCategory').value,
                price: parseFloat(document.getElementById('pPrice').value),
                stock: parseInt(document.getElementById('pStock').value),
                image: document.getElementById('pImage').value,
                description: document.getElementById('pDescription').value
            };

            if (id) {
                // Update existing
                const index = products.findIndex(p => p.id == id);
                products[index] = { ...products[index], ...productData };
            } else {
                // Add new
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({ id: newId, ...productData, sizes: ["S", "M", "L", "XL"] });
            }

            localStorage.setItem('brandorivk_config', JSON.stringify(CONFIG));
            closeModal();
            loadProducts();
        });

        function editProduct(id) {
            openModal(id);
        }

        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                const index = CONFIG.products.findIndex(p => p.id === id);
                CONFIG.products.splice(index, 1);
                localStorage.setItem('brandorivk_config', JSON.stringify(CONFIG));
                loadProducts();
            }
        }

        function saveToConfig() {
            alert('Changes saved! In production, this would update the config.js file.');
        }

        window.onclick = function(event) {
            const modal = document.getElementById('productModal');
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>