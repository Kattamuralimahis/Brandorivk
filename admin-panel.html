<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Brandorivk</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2c 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        .header h1 { margin-bottom: 0.5rem; }
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #ddd;
        }
        .tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        .tab:hover { background: #e9ecef; }
        .tab.active {
            background: white;
            color: #e67e22;
            border-bottom: 3px solid #e67e22;
        }
        .tab-content { display: none; padding: 2rem; }
        .tab-content.active { display: block; }
        
        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .product-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 1.5rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        .product-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #1a1a1a;
        }
        .product-category {
            color: #667eea;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            text-transform: uppercase;
            font-weight: 600;
        }
        .form-group { margin-bottom: 1rem; }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        .price-tag {
            font-size: 1.5rem;
            font-weight: 700;
            color: #27ae60;
            margin: 0.5rem 0;
        }
        .stock-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        .stock-badge.in-stock { background: #d4edda; color: #155724; }
        .stock-badge.low-stock { background: #fff3cd; color: #856404; }
        .stock-badge.out-of-stock { background: #f8d7da; color: #721c24; }
        
        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            margin: 0.3rem;
        }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5568d3; }
        .btn-success { background: #27ae60; color: white; }
        .btn-success:hover { background: #229954; }
        .btn-warning { background: #f39c12; color: white; }
        .btn-warning:hover { background: #e67e22; }
        .btn-danger { background: #e74c3c; color: white; }
        .btn-danger:hover { background: #c0392b; }
        
        /* Image Upload */
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s;
        }
        .upload-area:hover {
            background: #e9ecef;
            border-color: #764ba2;
        }
        .upload-area.dragover {
            background: #667eea;
            color: white;
        }
        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
        }
        
        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }
        .stat-card h3 { font-size: 2rem; margin-bottom: 0.3rem; }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }
        .toast.error { background: #e74c3c; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõçÔ∏è Brandorivk Admin Panel</h1>
            <p>Manage Products, Images, Prices & Stock</p>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('products')">üì¶ All Products</button>
            <button class="tab" onclick="switchTab('upload')">üì∏ Upload Images</button>
            <button class="tab" onclick="switchTab('bulk')">‚ö° Bulk Updates</button>
        </div>
        
        <!-- Products Tab -->
        <div id="products" class="tab-content active">
            <h2 style="margin-bottom: 1.5rem;">Manage Products</h2>
            <div class="stats-grid" id="statsGrid"></div>
            <div class="product-grid" id="productGrid"></div>
        </div>
        
        <!-- Upload Tab -->
        <div id="upload" class="tab-content">
            <h2 style="margin-bottom: 1.5rem;">Upload Product Images</h2>
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                <h3>üìÅ Drag & Drop Images Here</h3>
                <p>or click to browse</p>
                <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
            </div>
            <img id="previewImage" class="preview-image">
            <div id="uploadProgress" class="hidden" style="margin-top: 1rem;">
                <p>Uploading... <span class="loading"></span></p>
            </div>
            <div id="uploadedImages" style="margin-top: 2rem;"></div>
        </div>
        
        <!-- Bulk Updates Tab -->
        <div id="bulk" class="tab-content">
            <h2 style="margin-bottom: 1.5rem;">Bulk Price & Stock Updates</h2>
            <div style="background: #f8f9fa; padding: 2rem; border-radius: 12px; margin-bottom: 2rem;">
                <h3 style="margin-bottom: 1rem;">üìä Quick Updates</h3>
                <div class="form-group">
                    <label>Increase All Prices by (%)</label>
                    <input type="number" id="priceIncrease" placeholder="e.g., 10 for 10%">
                    <button class="btn btn-warning" onclick="bulkPriceUpdate('increase')" style="margin-top: 0.5rem;">Increase Prices</button>
                </div>
                <div class="form-group">
                    <label>Decrease All Prices by (%)</label>
                    <input type="number" id="priceDecrease" placeholder="e.g., 10 for 10%">
                    <button class="btn btn-warning" onclick="bulkPriceUpdate('decrease')" style="margin-top: 0.5rem;">Decrease Prices</button>
                </div>
                <div class="form-group">
                    <label>Add Stock to All Products</label>
                    <input type="number" id="stockAdd" placeholder="e.g., 20">
                    <button class="btn btn-success" onclick="bulkStockUpdate('add')" style="margin-top: 0.5rem;">Add Stock</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="toast" class="toast"></div>

    <script src="js/config.js"></script>
    <script>
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();
            setupDragAndDrop();
        });

        // Tab Switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            if (tabName === 'products') loadProducts();
        }

        // Load Products
        function loadProducts() {
            const products = getProducts();
            const grid = document.getElementById('productGrid');
            const stats = document.getElementById('statsGrid');
            
            grid.innerHTML = '';
            
            let totalProducts = products.length;
            let totalStock = products.reduce((sum, p) => sum + p.stock, 0);
            let totalValue = products.reduce((sum, p) => sum + (p.price * p.stock), 0);
            let lowStock = products.filter(p => p.stock < 5).length;

            stats.innerHTML = `
                <div class="stat-card"><h3>${totalProducts}</h3><p>Products</p></div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb, #f5576c);"><h3>${totalStock}</h3><p>Total Stock</p></div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe, #00f2fe);"><h3>$${totalValue.toFixed(2)}</h3><p>Inventory Value</p></div>
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b, #38f9d7);"><h3>${lowStock}</h3><p>Low Stock Items</p></div>
            `;

            products.forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';
                const stockClass = product.stock < 5 ? (product.stock === 0 ? 'out-of-stock' : 'low-stock') : 'in-stock';
                const stockText = product.stock === 0 ? 'Out of Stock' : (product.stock < 5 ? `Low Stock (${product.stock})` : `In Stock (${product.stock})`);
                
                card.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
                    <div class="product-name">${product.name}</div>
                    <div class="product-category">${product.category}</div>
                    <div class="price-tag">$${product.price.toFixed(2)}</div>
                    <span class="stock-badge ${stockClass}">${stockText}</span>
                    
                    <div class="form-group">
                        <label>Update Price ($)</label>
                        <input type="number" step="0.01" value="${product.price}" id="price-${product.id}">
                    </div>
                    <div class="form-group">
                        <label>Update Stock</label>
                        <input type="number" value="${product.stock}" id="stock-${product.id}">
                    </div>
                    <div class="form-group">
                        <label>Image URL</label>
                        <input type="text" value="${product.image}" id="image-${product.id}">
                    </div>
                    
                    <button class="btn btn-success" onclick="updateProduct(${product.id})">üíæ Save Changes</button>
                    <button class="btn btn-danger" onclick="deleteProduct(${product.id})">üóëÔ∏è Delete</button>
                `;
                grid.appendChild(card);
            });
        }

        // Update Product
        function updateProduct(id) {
            const products = getProducts();
            const product = products.find(p => p.id === id);
            
            if (product) {
                const newPrice = parseFloat(document.getElementById(`price-${id}`).value);
                const newStock = parseInt(document.getElementById(`stock-${id}`).value);
                const newImage = document.getElementById(`image-${id}`).value;
                
                product.price = newPrice;
                product.stock = newStock;
                product.image = newImage;
                
                saveConfig();
                showToast('Product updated successfully! ‚úÖ');
                loadProducts();
            }
        }

        // Delete Product
        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                const index = CONFIG.products.findIndex(p => p.id === id);
                CONFIG.products.splice(index, 1);
                saveConfig();
                showToast('Product deleted! üóëÔ∏è');
                loadProducts();
            }
        }

        // Drag & Drop Image Upload
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, () => uploadArea.classList.add('dragover'), false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('dragover'), false);
            });

            uploadArea.addEventListener('drop', handleDrop, false);
            fileInput.addEventListener('change', handleFiles, false);
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles({ target: { files: files } });
        }

        function handleFiles(e) {
            const files = e.target.files;
            Array.from(files).forEach(uploadImage);
        }

        // Upload to Imgur (Free Image Hosting)
        async function uploadImage(file) {
            const preview = document.getElementById('previewImage');
            const progress = document.getElementById('uploadProgress');
            
            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
            
            progress.classList.remove('hidden');
            
            // Upload to Imgur (Client ID required)
            const formData = new FormData();
            formData.append('image', file);
            
            try {
                const response = await fetch('https://api.imgur.com/3/image', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Client-ID YOUR_IMGUR_CLIENT_ID' // Replace with your Imgur Client ID
                    },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const imageUrl = data.data.link;
                    showToast(`Image uploaded! URL: ${imageUrl}`);
                    addImageUrlToList(imageUrl);
                } else {
                    throw new Error('Upload failed');
                }
            } catch (error) {
                // Fallback: Use local URL
                const localUrl = URL.createObjectURL(file);
                showToast('Image loaded locally. For permanent hosting, use Imgur or Cloudinary.');
                addImageUrlToList(localUrl);
            }
            
            progress.classList.add('hidden');
        }

        function addImageUrlToList(url) {
            const container = document.getElementById('uploadedImages');
            const div = document.createElement('div');
            div.style.cssText = 'background: #f8f9fa; padding: 1rem; margin: 0.5rem 0; border-radius: 8px;';
            div.innerHTML = `
                <img src="${url}" style="max-width: 200px; border-radius: 6px;">
                <p style="margin: 0.5rem 0;"><strong>URL:</strong></p>
                <input type="text" value="${url}" readonly style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
                <button class="btn btn-primary" onclick="copyToClipboard('${url}')" style="margin-top: 0.5rem;">üìã Copy URL</button>
            `;
            container.appendChild(div);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('URL copied to clipboard! üìã');
            });
        }

        // Bulk Updates
        function bulkPriceUpdate(type) {
            const percentage = type === 'increase' 
                ? parseFloat(document.getElementById('priceIncrease').value)
                : parseFloat(document.getElementById('priceDecrease').value);
            
            if (!percentage) {
                showToast('Please enter a percentage', 'error');
                return;
            }
            
            const products = getProducts();
            products.forEach(product => {
                if (type === 'increase') {
                    product.price = product.price * (1 + percentage / 100);
                } else {
                    product.price = product.price * (1 - percentage / 100);
                }
                product.price = Math.round(product.price * 100) / 100;
            });
            
            saveConfig();
            showToast(`Prices updated! ${type === 'increase' ? 'Increased' : 'Decreased'} by ${percentage}%`);
            loadProducts();
        }

        function bulkStockUpdate(action) {
            const amount = parseInt(document.getElementById('stockAdd').value);
            
            if (!amount) {
                showToast('Please enter an amount', 'error');
                return;
            }
            
            const products = getProducts();
            products.forEach(product => {
                product.stock += amount;
            });
            
            saveConfig();
            showToast(`Stock updated! Added ${amount} to all products`);
            loadProducts();
        }

        // Helper Functions
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast' + (type === 'error' ? ' error' : '');
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 3000);
        }

        function saveConfig() {
            localStorage.setItem('brandorivk_config', JSON.stringify(CONFIG));
        }
    </script>
</body>
</html>